{{ define "main" }}

{{/* Catalog sections: each category shows a small list + More */}}
{{ $gamesAll := where .Site.RegularPages "Section" "games" }}
{{ $catMap := site.Data.cat_map }}
{{ range $id, $catName := $catMap }}
    {{ $catPages := slice }}
    {{ range $gamesAll }}
        {{ if in .Params.categories $catName }}
            {{ $catPages = $catPages | append . }}
        {{ end }}
    {{ end }}
    {{ if gt (len $catPages) 0 }}
        <section class="catalog-section">
            <h2 class="section-title">{{ $catName }}</h2>
            <div class="catalog-box">
                <div class="catalog-header">
                    <a class="more-btn" href="{{ (printf "/categories/%s/" $catName | urlize) | relURL }}">View All →</a>
                </div>
                <div class="catalog-list">
                    {{ range first 10 $catPages }}
                        <div class="game-card small">
                            <a href="{{ .Permalink }}">
                                <div class="thumbnail">
                                    <img src="{{ .Params.thumbnail }}" alt="{{ .Title }}">
                                    <span class="play-btn">▶</span>
                                </div>
                                <div class="info"><h3>{{ .Title }}</h3></div>
                            </a>
                        </div>
                    {{ end }}
                </div>
            </div>
        </section>
    {{ end }}
{{ end }}

{{ end }}